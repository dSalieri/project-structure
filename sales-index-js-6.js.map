{"version":3,"sources":["webpack:///./src/pages/sales/sales-header.js","webpack:///./src/pages/sales/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/notification/index.js","webpack:///./src/utils/comma.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/range-picker/index.js"],"names":["header","id","title","sortable","sortType","template","date","Date","toLocaleString","dateStyle","price","comma","Page","from","to","sortableTable","this","components","url","searchParams","set","toISOString","update","initComponents","now","setMonth","getMonth","rangePicker","RangePicker","SortableTable","sorted","order","step","isSortLocally","scrollLoad","renderComponents","Object","keys","forEach","component","root","subElements","element","append","render","document","createElement","innerHTML","firstElementChild","getSubElements","initEventListeners","querySelectorAll","reduce","acc","subElement","dataset","addEventListener","event","detail","updateComponents","remove","destroy","values","params","response","body","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","data","status","Error","constructor","super","window","reason","Notification","duration","type","show","NotificationMessage","wrapper","target","activeMessage","timerId","setTimeout","clearTimeout","num","String","reverse","chr","index","push","length","join","headersConfig","find","item","rowTemplate","start","end","Promise","resolve","isLoaded","async","bottom","getBoundingClientRect","documentElement","clientHeight","loading","loadData","addRows","column","closest","newOrder","asc","desc","toggleOrder","arrow","sortOnClient","sortOnServer","URL","getTable","renderRows","classList","add","fetchJson","getTableRows","rows","childNodes","getTableHeader","map","getHeaderRow","getHeaderSortingArrow","getTableBody","getTableRow","onSortClick","onWindowScroll","sortedData","sortData","arr","customSorting","direction","sort","a","b","localeCompare","accum","removeEventListener","isOpen","contains","isRangePicker","close","showDateFrom","selected","formatDate","input","selector","onDocumentClick","toggle","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","showDate1","showDate2","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","value","cellDate","selectedFromElem","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","getDate","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles"],"mappings":"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","file":"sales-index-js-6.js","sourcesContent":["import comma from \"../../utils/comma.js\";\r\n\r\nconst header = [\r\n  {\r\n    id: \"id\",\r\n    title: \"ID\",\r\n    sortable: true,\r\n  },\r\n  {\r\n    id: \"user\",\r\n    title: \"Client\",\r\n    sortable: true,\r\n    sortType: \"string\",\r\n  },\r\n  {\r\n    id: \"createdAt\",\r\n    title: \"Date\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (date) => {\r\n      return `<div class=\"sortable-table__cell\">${new Date(date).toLocaleString(\r\n        \"default\",\r\n        { dateStyle: \"medium\" }\r\n      )}</div>`;\r\n    },\r\n  },\r\n  {\r\n    id: \"totalCost\",\r\n    title: \"Price\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (price) => {\r\n      return `<div class=\"sortable-table__cell\">${comma(price)}$</div>`;\r\n    },\r\n  },\r\n  {\r\n    id: \"delivery\",\r\n    title: \"Status\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n  },\r\n];\r\n\r\nexport default header;\r\n","import RangePicker from \"../../components/range-picker/index.js\";\r\nimport SortableTable from \"../../components/sortable-table/index.js\";\r\nimport header from \"./sales-header.js\";\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n\r\n  async updateComponents(from, to) {\r\n    const sortableTable = this.components.sortableTable;\r\n    sortableTable.url.searchParams.set(\"createdAt_gte\", from.toISOString());\r\n    sortableTable.url.searchParams.set(\"createdAt_lte\", to.toISOString());\r\n\r\n    sortableTable.update();\r\n  }\r\n\r\n  initComponents() {\r\n    const now = new Date();\r\n    const to = new Date();\r\n    const from = new Date(now.setMonth(now.getMonth() - 1));\r\n\r\n    const rangePicker = new RangePicker({ from, to });\r\n\r\n    const sortableTable = new SortableTable(header, {\r\n      url: `api/rest/orders?createdAt_gte=${from.toISOString()}&createdAt_lte=${to.toISOString()}`,\r\n      sorted: { id: \"createdAt\", order: \"desc\" },\r\n      step: 30,\r\n      isSortLocally: false,\r\n      scrollLoad: true,\r\n    });\r\n\r\n    this.components = {\r\n      rangePicker,\r\n      sortableTable,\r\n    };\r\n  }\r\n  renderComponents() {\r\n    Object.keys(this.components).forEach((component) => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      if (element) root.append(element);\r\n    });\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"sales full-height flex-column\">\r\n        <div class=\"content__top-panel\">\r\n          <h2 class=\"page-title\">Sales</h2>\r\n          <!-- RangePicker component -->\r\n          <div data-element=\"rangePicker\"></div>\r\n        </div>\r\n        <div data-element=\"sortableTable\">\r\n          <!-- sortable-table component -->\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement(\"div\");\r\n    element.innerHTML = this.template;\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.initComponents();\r\n    this.renderComponents();\r\n    this.initEventListeners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll(\"[data-element]\");\r\n\r\n    return [...elements].reduce((acc, subElement) => {\r\n      acc[subElement.dataset.element] = subElement;\r\n\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.components.rangePicker.element.addEventListener(\r\n      \"date-select\",\r\n      (event) => {\r\n        const { from, to } = event.detail;\r\n        this.updateComponents(from, to);\r\n      }\r\n    );\r\n  }\r\n\r\n  remove() {\r\n    if (this.element) this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\nimport Notification from \"../components/notification/index.js\";\r\n\r\nexport default async function (url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // TODO: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch (err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText =\r\n        (body.error && body.error.message) ||\r\n        (body.data && body.data.error && body.data.error.message) ||\r\n        errorText;\r\n    } catch (error) {\r\n      /* ignore failed body */\r\n    }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch (err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener(\"unhandledrejection\", (event) => {\r\n  if (event.reason instanceof FetchError) {\r\n    ///alert(event.reason.message);\r\n      const notification = new Notification(event.reason.message, {\r\n        duration: 3000,\r\n        type: 'error'\r\n      });\r\n      notification.show();\r\n  }\r\n});\r\n","export default class NotificationMessage {\r\n  static activeMessage;\r\n  element;\r\n\r\n  constructor(message, { duration = 1000, type = \"success\" } = {}) {\r\n    this.message = message;\r\n    this.duration = duration;\r\n    this.type = type;\r\n    this.createElement();\r\n  }\r\n  get template() {\r\n    return /*html*/ `\r\n      <div class=\"notification notification_${this.type}\" style=\"--value:${\r\n      this.duration / 1000\r\n    }s\">\r\n        <div class=\"notification__content notification__content_show\">\r\n            ${this.message}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n  createElement() {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n  }\r\n  show(target = document.body) {\r\n    if (NotificationMessage.activeMessage)\r\n      NotificationMessage.activeMessage.remove();\r\n\r\n    target.append(this.element);\r\n\r\n    this.timerId = setTimeout(() => {\r\n      this.remove();\r\n    }, this.duration);\r\n\r\n    NotificationMessage.activeMessage = this;\r\n  }\r\n  remove() {\r\n    clearTimeout(this.timerId);\r\n    if (this.element) this.element.remove();\r\n  }\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    NotificationMessage.activeMessage = null;\r\n  }\r\n}\r\n","export default function comma(num) {\r\n  num = String(num);\r\n  return [...num]\r\n    .reverse()\r\n    .reduce((acc, chr, index) => {\r\n      acc.push(chr);\r\n      if ((index + 1) % 3 === 0 && index < num.length - 1) acc.push(\",\");\r\n      return acc;\r\n    }, [])\r\n    .reverse()\r\n    .join(\"\");\r\n}\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  isLoaded;\r\n  componentIsLoaded = new Promise(resolve => {\r\n    this.isLoaded = resolve;\r\n  });\r\n\r\n  onWindowScroll = async () => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading) {\r\n      this.loading = true;\r\n\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.addRows(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n    const toggleOrder = order => {\r\n      const orders = {\r\n        asc: 'desc',\r\n        desc: 'asc'\r\n      };\r\n\r\n      return orders[order];\r\n    };\r\n\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const newOrder = toggleOrder(order);\r\n\r\n      this.sorted = {\r\n        id,\r\n        order: newOrder\r\n      };\r\n\r\n      column.dataset.order = newOrder;\r\n      column.append(this.subElements.arrow);\r\n\r\n      if (this.isSortLocally) {\r\n        this.sortOnClient(id, newOrder);\r\n      } else {\r\n        this.sortOnServer(id, newOrder);\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(\r\n    headersConfig = [],\r\n    {\r\n      url = '',\r\n      sorted = {\r\n        id: headersConfig.find(item => item.sortable).id,\r\n        order: 'asc'\r\n      },\r\n      isSortLocally = false,\r\n      scrollLoad = true,\r\n      rowTemplate = data => `<div class=\"sortable-table__row\">${data}</div>`,\r\n      step = 20,\r\n      start = 0,\r\n      end = start + step\r\n    } = {}\r\n  ) {\r\n    this.headersConfig = headersConfig;\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.scrollLoad = scrollLoad;\r\n    this.rowTemplate = rowTemplate;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const { id, order } = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTable();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.isLoaded();\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  async update(data) {\r\n    this.subElements.body.innerHTML = '';\r\n    if (typeof data === 'function') {\r\n      this.element.classList.add('sortable-table_loading');\r\n      this.data = await data();\r\n      this.element.classList.remove('sortable-table_loading');\r\n    } else {\r\n      let {\r\n        id = this.sorted.id,\r\n        order = this.sorted.order,\r\n        start = this.start,\r\n        end = this.end\r\n      } = data || {};\r\n      this.data = await this.loadData(id, order, start, end);\r\n    }\r\n\r\n    if (!this.data.length) this.element.classList.add('sortable-table_empty');\r\n    else this.element.classList.remove('sortable-table_empty');\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(this.data);\r\n  }\r\n\r\n  addRows(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.getTableRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `<div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n      ${this.headersConfig.map(item => this.getHeaderRow(item)).join('')}\r\n    </div>`;\r\n  }\r\n\r\n  getHeaderRow({ id, title, sortable }) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${order}\">\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => this.rowTemplate(this.getTableRow(item), item)).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({ id, template }) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells\r\n      .map(({ id, template }) => {\r\n        return template\r\n          ? template(item[id])\r\n          : `<div class=\"sortable-table__cell\">${item[id]}</div>`;\r\n      })\r\n      .join('');\r\n  }\r\n\r\n  getTable() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          No products\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    if (this.scrollLoad) document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  sortOnClient(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order) {\r\n    this.start = 0;\r\n    this.end = this.start + this.step;\r\n\r\n    this.subElements.body.innerHTML = '';\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find(item => item.id === id);\r\n    const { sortType, customSorting } = column;\r\n    const direction = order === 'asc' ? 1 : -1;\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], 'ru');\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.subElements = {};\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n}\r\n","export default class RangePicker {\r\n  element = null;\r\n  subElements = {};\r\n  selectingFrom = true;\r\n  selected = {\r\n    from: new Date(),\r\n    to: new Date()\r\n  };\r\n\r\n  static formatDate(date) {\r\n    return date.toLocaleString('ru', {dateStyle: 'short'});\r\n  }\r\n\r\n  onDocumentClick = event => {\r\n    const isOpen = this.element.classList.contains('rangepicker_open');\r\n    const isRangePicker = this.element.contains(event.target);\r\n\r\n    if (isOpen && !isRangePicker) {\r\n      this.close();\r\n    }\r\n  };\r\n\r\n  constructor({from = new Date(), to = new Date()} = {}) {\r\n    this.showDateFrom = new Date(from);\r\n    this.selected = {from, to};\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    const from = RangePicker.formatDate(this.selected.from);\r\n    const to = RangePicker.formatDate(this.selected.to);\r\n\r\n    return `<div class=\"rangepicker\">\r\n      <div class=\"rangepicker__input\" data-element=\"input\">\r\n        <span data-element=\"from\">${from}</span> -\r\n        <span data-element=\"to\">${to}</span>\r\n      </div>\r\n      <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const subElements = {};\r\n\r\n    for (const subElement of element.querySelectorAll('[data-element]')) {\r\n      subElements[subElement.dataset.element] = subElement;\r\n    }\r\n\r\n    return subElements;\r\n  }\r\n\r\n  initEventListeners() {\r\n    const {input, selector} = this.subElements;\r\n\r\n    document.addEventListener('click', this.onDocumentClick, true);\r\n    input.addEventListener('click', () => this.toggle());\r\n    selector.addEventListener('click', event => this.onSelectorClick(event));\r\n  }\r\n\r\n  toggle() {\r\n    this.element.classList.toggle('rangepicker_open');\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  onSelectorClick({target}) {\r\n    if (target.classList.contains('rangepicker__cell')) {\r\n      this.onRangePickerCellClick(target);\r\n    }\r\n  }\r\n\r\n  close() {\r\n    this.element.classList.remove('rangepicker_open');\r\n  }\r\n\r\n  renderDateRangePicker() {\r\n    const showDate1 = new Date(this.showDateFrom);\r\n    const showDate2 = new Date(this.showDateFrom);\r\n    const { selector } = this.subElements;\r\n\r\n    showDate2.setMonth(showDate2.getMonth() + 1);\r\n\r\n    selector.innerHTML = `\r\n      <div class=\"rangepicker__selector-arrow\"></div>\r\n      <div class=\"rangepicker__selector-control-left\"></div>\r\n      <div class=\"rangepicker__selector-control-right\"></div>\r\n      ${this.renderCalendar(showDate1)}\r\n      ${this.renderCalendar(showDate2)}\r\n    `;\r\n\r\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\r\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\r\n\r\n    controlLeft.addEventListener('click', () => this.prev());\r\n    controlRight.addEventListener('click', () => this.next());\r\n\r\n    this.renderHighlight();\r\n  }\r\n\r\n  prev() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  next() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  renderHighlight() {\r\n    const { from, to } = this.selected;\r\n\r\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\r\n      const { value } = cell.dataset;\r\n      const cellDate = new Date(value);\r\n\r\n      cell.classList.remove('rangepicker__selected-from');\r\n      cell.classList.remove('rangepicker__selected-between');\r\n      cell.classList.remove('rangepicker__selected-to');\r\n\r\n      if (from && value === from.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-from');\r\n      } else if (to && value === to.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-to');\r\n      } else if (from && to && cellDate >= from && cellDate <= to) {\r\n        cell.classList.add('rangepicker__selected-between');\r\n      }\r\n    }\r\n\r\n    if (from) {\r\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\r\n      if (selectedFromElem) {\r\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\r\n      }\r\n    }\r\n\r\n    if (to) {\r\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\r\n      if (selectedToElem) {\r\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCalendar(showDate) {\r\n    const date = new Date(showDate);\r\n    const getGridStartIndex = dayIndex => {\r\n      const index = dayIndex === 0 ? 6 : (dayIndex - 1); // make Sunday (0) the last day\r\n      return index + 1;\r\n    };\r\n\r\n    date.setDate(1);\r\n\r\n    // text-transform: capitalize\r\n    const monthStr = date.toLocaleString('ru', {month: 'long'});\r\n\r\n    let table = `<div class=\"rangepicker__calendar\">\r\n      <div class=\"rangepicker__month-indicator\">\r\n        <time datetime=${monthStr}>${monthStr}</time>\r\n      </div>\r\n      <div class=\"rangepicker__day-of-week\">\r\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\r\n      </div>\r\n      <div class=\"rangepicker__date-grid\">\r\n    `;\r\n\r\n    // first day of month starts after a space\r\n    // * * * 1 2 3 4\r\n    table += `\r\n      <button type=\"button\"\r\n        class=\"rangepicker__cell\"\r\n        data-value=\"${date.toISOString()}\"\r\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\r\n          ${date.getDate()}\r\n      </button>`;\r\n\r\n    date.setDate(2);\r\n\r\n    while (date.getMonth() === showDate.getMonth()) {\r\n      table += `\r\n        <button type=\"button\"\r\n          class=\"rangepicker__cell\"\r\n          data-value=\"${date.toISOString()}\">\r\n            ${date.getDate()}\r\n        </button>`;\r\n\r\n      date.setDate(date.getDate() + 1);\r\n    }\r\n\r\n    // close the table\r\n    table += '</div></div>';\r\n\r\n    return table;\r\n  }\r\n\r\n  onRangePickerCellClick(target) {\r\n    const { value } = target.dataset;\r\n\r\n    if (value) {\r\n      const dateValue = new Date(value);\r\n\r\n      if (this.selectingFrom) {\r\n        this.selected = {\r\n          from: dateValue,\r\n          to: null\r\n        };\r\n        this.selectingFrom = false;\r\n        this.renderHighlight();\r\n      } else {\r\n        if (dateValue > this.selected.from) {\r\n          this.selected.to = dateValue;\r\n        } else {\r\n          this.selected.to = this.selected.from;\r\n          this.selected.from = dateValue;\r\n        }\r\n\r\n        this.selectingFrom = true;\r\n        this.renderHighlight();\r\n      }\r\n\r\n      if (this.selected.from && this.selected.to) {\r\n        this.dispatchEvent();\r\n        this.close();\r\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\r\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to);\r\n      }\r\n    }\r\n  }\r\n\r\n  dispatchEvent() {\r\n    this.element.dispatchEvent(new CustomEvent('date-select', {\r\n      bubbles: true,\r\n      detail: this.selected\r\n    }));\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n    // TODO: Warning! To remove listener MUST be passes the same event phase\r\n    document.removeEventListener('click', this.onDocumentClick, true);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n    this.selectingFrom = true;\r\n    this.selected = {\r\n      from: new Date(),\r\n      to: new Date()\r\n    };\r\n\r\n    return this;\r\n  }\r\n}\r\n"],"sourceRoot":""}