{"version":3,"sources":["webpack:///./src/pages/products/list/products-header.js","webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/utils/debounce.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/notification/index.js","webpack:///./src/utils/comma.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/tooltip/index.js"],"names":["header","id","title","sortable","template","data","url","sortType","category","catTitle","price","comma","DoubleSlider","constructor","min","max","formatValue","value","selected","from","to","event","preventDefault","left","innerLeft","right","innerRight","width","this","subElements","inner","getBoundingClientRect","dragging","thumbLeft","newLeft","clientX","shiftX","parseFloat","thumbRight","style","progress","innerHTML","getValue","newRight","element","classList","remove","document","removeEventListener","onThumbPointerMove","onThumbPointerUp","dispatchEvent","CustomEvent","detail","bubbles","render","createElement","firstElementChild","ondragstart","getSubElements","initEventListeners","update","addEventListener","onThumbPointerDown","result","elements","querySelectorAll","subElement","dataset","destroy","rangeTotal","Math","floor","thumbElem","target","add","round","console","log","Page","URL","func","delay","timerId","calls","args","clearTimeout","setTimeout","throttle","changeParamsURL","call","components","productsContainer","updateComponents","start","end","name","searchParams","delete","set","initComponents","SortableTable","sorted","order","step","isSortLocally","scrollLoad","rowTemplate","item","sliderContainer","tooltip","Tooltip","initialize","renderComponents","Object","keys","forEach","component","root","append","reduce","acc","filterName","onInputThrottled","onSliderChange","filterStatus","onOptionChange","values","params","response","body","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","Notification","duration","type","show","NotificationMessage","wrapper","activeMessage","num","String","reverse","chr","index","push","length","join","headersConfig","find","Promise","resolve","isLoaded","async","bottom","documentElement","clientHeight","loading","loadData","addRows","column","closest","newOrder","asc","desc","toggleOrder","arrow","sortOnClient","sortOnServer","getTable","renderRows","fetchJson","getTableRows","rows","childNodes","getTableHeader","map","getHeaderRow","getHeaderSortingArrow","getTableBody","getTableRow","onSortClick","onWindowScroll","sortedData","sortData","arr","customSorting","direction","sort","a","b","localeCompare","accum","top","clientY","moveHandler","instance","html","className","overHandler","outHandler"],"mappings":"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","file":"products-list-index-js-5.js","sourcesContent":["import comma from \"../../../utils/comma.js\";\r\n\r\nconst header = [\r\n  {\r\n    id: \"images\",\r\n    title: \"Image\",\r\n    sortable: false,\r\n    template: (data = []) => {\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0] && data[0].url}\">\r\n        </div>\r\n      `;\r\n    },\r\n  },\r\n  {\r\n    id: \"title\",\r\n    title: \"Name\",\r\n    sortable: true,\r\n    sortType: \"string\",\r\n  },\r\n  {\r\n    id: \"subcategory\",\r\n    title: \"Category\",\r\n    sortable: false,\r\n    template: ({ category: { title: catTitle }, title } = {}) => {\r\n      const template = `\r\n        <div class='sortable-table-tooltip'>\r\n          <span class='sortable-table-tooltip__category'>${catTitle}</span> /\r\n          <b class='sortable-table-tooltip__subcategory'>${title}</b>\r\n        </div>\r\n      `;\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <span data-tooltip=\"${template}\">${title}</span>\r\n        </div>\r\n      `;\r\n    },\r\n  },\r\n  {\r\n    id: \"quantity\",\r\n    title: \"Quantity\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n  },\r\n  {\r\n    id: \"price\",\r\n    title: \"Price\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (price) => {\r\n      return `<div class=\"sortable-table__cell\">${comma(price)}$</div>`;\r\n    },\r\n  },\r\n  {\r\n    id: \"status\",\r\n    title: \"Status\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (data) => {\r\n      return `<div class=\"sortable-table__cell\">\r\n          ${data > 0 ? \"Active\" : \"Inactive\"}\r\n        </div>`;\r\n    },\r\n  },\r\n];\r\n\r\nexport default header;\r\n","export default class DoubleSlider {\r\n  element;\r\n  subElements = {};\r\n\r\n  onThumbPointerMove = (event) => {\r\n    event.preventDefault();\r\n\r\n    const {\r\n      left: innerLeft,\r\n      right: innerRight,\r\n      width,\r\n    } = this.subElements.inner.getBoundingClientRect();\r\n\r\n    if (this.dragging === this.subElements.thumbLeft) {\r\n      let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\r\n\r\n      if (newLeft < 0) {\r\n        newLeft = 0;\r\n      }\r\n      newLeft *= 100;\r\n      const right = parseFloat(this.subElements.thumbRight.style.right);\r\n\r\n      if (newLeft + right > 100) {\r\n        newLeft = 100 - right;\r\n      }\r\n\r\n      this.dragging.style.left = this.subElements.progress.style.left =\r\n        newLeft + \"%\";\r\n      this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\r\n    }\r\n\r\n    if (this.dragging === this.subElements.thumbRight) {\r\n      let newRight = (innerRight - event.clientX - this.shiftX) / width;\r\n\r\n      if (newRight < 0) {\r\n        newRight = 0;\r\n      }\r\n      newRight *= 100;\r\n\r\n      const left = parseFloat(this.subElements.thumbLeft.style.left);\r\n\r\n      if (left + newRight > 100) {\r\n        newRight = 100 - left;\r\n      }\r\n      this.dragging.style.right = this.subElements.progress.style.right =\r\n        newRight + \"%\";\r\n      this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\r\n    }\r\n  };\r\n\r\n  onThumbPointerUp = () => {\r\n    this.element.classList.remove(\"range-slider_dragging\");\r\n\r\n    document.removeEventListener(\"pointermove\", this.onThumbPointerMove);\r\n    document.removeEventListener(\"pointerup\", this.onThumbPointerUp);\r\n\r\n    this.element.dispatchEvent(\r\n      new CustomEvent(\"range-select\", {\r\n        detail: this.getValue(),\r\n        bubbles: true,\r\n      })\r\n    );\r\n  };\r\n\r\n  constructor({\r\n    min = 100,\r\n    max = 200,\r\n    formatValue = (value) => \"$\" + value,\r\n    selected = {\r\n      from: min,\r\n      to: max,\r\n    },\r\n  } = {}) {\r\n    this.min = min;\r\n    this.max = max;\r\n    this.formatValue = formatValue;\r\n    this.selected = selected;\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    const { from, to } = this.selected;\r\n\r\n    return `<div class=\"range-slider\">\r\n      <span data-element=\"from\">${this.formatValue(from)}</span>\r\n      <div data-element=\"inner\" class=\"range-slider__inner\">\r\n        <span data-element=\"progress\" class=\"range-slider__progress\"></span>\r\n        <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\r\n        <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\r\n      </div>\r\n      <span data-element=\"to\">${this.formatValue(to)}</span>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement(\"div\");\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.element.ondragstart = () => false;\r\n\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n\r\n    this.update();\r\n  }\r\n\r\n  initEventListeners() {\r\n    const { thumbLeft, thumbRight } = this.subElements;\r\n\r\n    thumbLeft.addEventListener(\"pointerdown\", (event) =>\r\n      this.onThumbPointerDown(event)\r\n    );\r\n    thumbRight.addEventListener(\"pointerdown\", (event) =>\r\n      this.onThumbPointerDown(event)\r\n    );\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const result = {};\r\n    const elements = element.querySelectorAll(\"[data-element]\");\r\n\r\n    for (const subElement of elements) {\r\n      const name = subElement.dataset.element;\r\n\r\n      result[name] = subElement;\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    document.removeEventListener(\"pointermove\", this.onThumbPointerMove);\r\n    document.removeEventListener(\"pointerup\", this.onThumbPointerUp);\r\n  }\r\n\r\n  update() {\r\n    const rangeTotal = this.max - this.min;\r\n    const left =\r\n      Math.floor(((this.selected.from - this.min) / rangeTotal) * 100) + \"%\";\r\n    const right =\r\n      Math.floor(((this.max - this.selected.to) / rangeTotal) * 100) + \"%\";\r\n\r\n    this.subElements.progress.style.left = left;\r\n    this.subElements.progress.style.right = right;\r\n\r\n    this.subElements.thumbLeft.style.left = left;\r\n    this.subElements.thumbRight.style.right = right;\r\n  }\r\n\r\n  onThumbPointerDown(event) {\r\n    const thumbElem = event.target;\r\n\r\n    event.preventDefault();\r\n\r\n    const { left, right } = thumbElem.getBoundingClientRect();\r\n\r\n    if (thumbElem === this.subElements.thumbLeft) {\r\n      this.shiftX = right - event.clientX;\r\n    } else {\r\n      this.shiftX = left - event.clientX;\r\n    }\r\n\r\n    this.dragging = thumbElem;\r\n\r\n    this.element.classList.add(\"range-slider_dragging\");\r\n\r\n    document.addEventListener(\"pointermove\", this.onThumbPointerMove);\r\n    document.addEventListener(\"pointerup\", this.onThumbPointerUp);\r\n  }\r\n\r\n  getValue() {\r\n    const rangeTotal = this.max - this.min;\r\n    const { left } = this.subElements.thumbLeft.style;\r\n    const { right } = this.subElements.thumbRight.style;\r\n\r\n    const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\r\n    const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\r\n\r\n    return { from, to };\r\n  }\r\n}\r\n","import SortableTable from '../../../components/sortable-table/index.js';\r\nimport header from './products-header.js';\r\nimport Tooltip from '../../../components/tooltip/index.js';\r\nimport DoubleSlider from '../../../components/double-slider/index.js';\r\n\r\nimport throttle from '../../../utils/debounce.js';\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru/';\r\nconst URL_PATH = process.env.URL_PATH;\r\nconsole.log('test');\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n  url = new URL('api/rest/products', BACKEND_URL);\r\n\r\n  onInputThrottled = throttle(event => {\r\n    this.changeParamsURL.call(this.components.productsContainer, 'title_like', event.target.value);\r\n    this.updateComponents();\r\n  }, 1000);\r\n\r\n  onSliderChange = event => {\r\n    this.changeParamsURL.call(this.components.productsContainer, 'price_gte', event.detail.from);\r\n    this.changeParamsURL.call(this.components.productsContainer, 'price_lte', event.detail.to);\r\n    this.updateComponents();\r\n  };\r\n  onOptionChange = event => {\r\n    const value = event.target.value;\r\n    this.changeParamsURL.call(\r\n      this.components.productsContainer,\r\n      'status',\r\n      value === '' ? null : value\r\n    );\r\n    this.updateComponents();\r\n  };\r\n\r\n  async updateComponents() {\r\n    this.components.productsContainer.start = 0;\r\n    this.components.productsContainer.end = 30;\r\n    this.components.productsContainer.update();\r\n  }\r\n\r\n  changeParamsURL(name, value) {\r\n    if (value == null) this.url.searchParams.delete(name);\r\n    else this.url.searchParams.set(name, value);\r\n  }\r\n\r\n  initComponents() {\r\n    const productsContainer = new SortableTable(header, {\r\n      url: this.url + '?_embed=subcategory.category',\r\n      sorted: {\r\n        id: 'title',\r\n        order: 'asc'\r\n      },\r\n      start: 0,\r\n      step: 30,\r\n      isSortLocally: false,\r\n      scrollLoad: true,\r\n      rowTemplate: (data, item) =>\r\n        `<a href=\"/products/${item.id}\" class=\"sortable-table__row\">${data}</a>`\r\n    });\r\n\r\n    const sliderContainer = new DoubleSlider({ min: 0, max: 4000 });\r\n\r\n    const tooltip = new Tooltip();\r\n    tooltip.initialize();\r\n\r\n    this.components = {\r\n      productsContainer,\r\n      sliderContainer,\r\n      tooltip\r\n    };\r\n  }\r\n  renderComponents() {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      if (element) root.append(element);\r\n    });\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"products-list\">\r\n        <div class=\"content__top-panel\">\r\n          <h1 class=\"page-title\">Products</h1>\r\n          <a href=\"products/add\" class=\"button-primary\">Add product</a>\r\n        </div>\r\n        <div class=\"content-box content-box_small\">\r\n          <form data-element=\"form\" class=\"form-inline\">\r\n            <div class=\"form-group\">\r\n              <label class=\"form-label\">Sort by:</label>\r\n              <input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Name product\">\r\n            </div>\r\n            <div class=\"form-group\" data-element=\"sliderContainer\">\r\n              <label class=\"form-label\">Price:</label>\r\n              <!-- double-slider component -->\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label class=\"form-label\">Status:</label>\r\n              <select class=\"form-control\" data-element=\"filterStatus\">\r\n                <option value=\"\" selected=\"\">Any</option>\r\n                <option value=\"1\">Active</option>\r\n                <option value=\"0\">Inactive</option>\r\n              </select>\r\n            </div>\r\n          </form>\r\n        </div>\r\n        <div data-element=\"productsContainer\" class=\"products-list__container\">\r\n          <!-- sortable-table component -->\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n    element.innerHTML = this.template;\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.initComponents();\r\n    this.renderComponents();\r\n    this.initEventListeners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((acc, subElement) => {\r\n      acc[subElement.dataset.element] = subElement;\r\n\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.filterName.addEventListener('input', this.onInputThrottled);\r\n    this.subElements.sliderContainer.addEventListener('range-select', this.onSliderChange);\r\n    this.subElements.filterStatus.addEventListener('change', this.onOptionChange);\r\n  }\r\n\r\n  remove() {\r\n    if (this.element) this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}\r\n","export default function (func, delay) {\r\n  let timerId;\r\n  let calls = 0;\r\n  return function (args) {\r\n    if (calls === 0) func(args);\r\n    clearTimeout(timerId);\r\n    timerId = setTimeout(function () {\r\n      if (calls > 1) func(args);\r\n      calls = 0;\r\n    }, delay);\r\n    calls++;\r\n  };\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\nimport Notification from \"../components/notification/index.js\";\r\n\r\nexport default async function (url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // TODO: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch (err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText =\r\n        (body.error && body.error.message) ||\r\n        (body.data && body.data.error && body.data.error.message) ||\r\n        errorText;\r\n    } catch (error) {\r\n      /* ignore failed body */\r\n    }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch (err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener(\"unhandledrejection\", (event) => {\r\n  if (event.reason instanceof FetchError) {\r\n    ///alert(event.reason.message);\r\n      const notification = new Notification(event.reason.message, {\r\n        duration: 3000,\r\n        type: 'error'\r\n      });\r\n      notification.show();\r\n  }\r\n});\r\n","export default class NotificationMessage {\r\n  static activeMessage;\r\n  element;\r\n\r\n  constructor(message, { duration = 1000, type = \"success\" } = {}) {\r\n    this.message = message;\r\n    this.duration = duration;\r\n    this.type = type;\r\n    this.createElement();\r\n  }\r\n  get template() {\r\n    return /*html*/ `\r\n      <div class=\"notification notification_${this.type}\" style=\"--value:${\r\n      this.duration / 1000\r\n    }s\">\r\n        <div class=\"notification__content notification__content_show\">\r\n            ${this.message}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n  createElement() {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n  }\r\n  show(target = document.body) {\r\n    if (NotificationMessage.activeMessage)\r\n      NotificationMessage.activeMessage.remove();\r\n\r\n    target.append(this.element);\r\n\r\n    this.timerId = setTimeout(() => {\r\n      this.remove();\r\n    }, this.duration);\r\n\r\n    NotificationMessage.activeMessage = this;\r\n  }\r\n  remove() {\r\n    clearTimeout(this.timerId);\r\n    if (this.element) this.element.remove();\r\n  }\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    NotificationMessage.activeMessage = null;\r\n  }\r\n}\r\n","export default function comma(num) {\r\n  num = String(num);\r\n  return [...num]\r\n    .reverse()\r\n    .reduce((acc, chr, index) => {\r\n      acc.push(chr);\r\n      if ((index + 1) % 3 === 0 && index < num.length - 1) acc.push(\",\");\r\n      return acc;\r\n    }, [])\r\n    .reverse()\r\n    .join(\"\");\r\n}\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  isLoaded;\r\n  componentIsLoaded = new Promise(resolve => {\r\n    this.isLoaded = resolve;\r\n  });\r\n\r\n  onWindowScroll = async () => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading) {\r\n      this.loading = true;\r\n\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.addRows(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n    const toggleOrder = order => {\r\n      const orders = {\r\n        asc: 'desc',\r\n        desc: 'asc'\r\n      };\r\n\r\n      return orders[order];\r\n    };\r\n\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const newOrder = toggleOrder(order);\r\n\r\n      this.sorted = {\r\n        id,\r\n        order: newOrder\r\n      };\r\n\r\n      column.dataset.order = newOrder;\r\n      column.append(this.subElements.arrow);\r\n\r\n      if (this.isSortLocally) {\r\n        this.sortOnClient(id, newOrder);\r\n      } else {\r\n        this.sortOnServer(id, newOrder);\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(\r\n    headersConfig = [],\r\n    {\r\n      url = '',\r\n      sorted = {\r\n        id: headersConfig.find(item => item.sortable).id,\r\n        order: 'asc'\r\n      },\r\n      isSortLocally = false,\r\n      scrollLoad = true,\r\n      rowTemplate = data => `<div class=\"sortable-table__row\">${data}</div>`,\r\n      step = 20,\r\n      start = 0,\r\n      end = start + step\r\n    } = {}\r\n  ) {\r\n    this.headersConfig = headersConfig;\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.scrollLoad = scrollLoad;\r\n    this.rowTemplate = rowTemplate;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const { id, order } = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTable();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.isLoaded();\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  async update(data) {\r\n    this.subElements.body.innerHTML = '';\r\n    if (typeof data === 'function') {\r\n      this.element.classList.add('sortable-table_loading');\r\n      this.data = await data();\r\n      this.element.classList.remove('sortable-table_loading');\r\n    } else {\r\n      let {\r\n        id = this.sorted.id,\r\n        order = this.sorted.order,\r\n        start = this.start,\r\n        end = this.end\r\n      } = data || {};\r\n      this.data = await this.loadData(id, order, start, end);\r\n    }\r\n\r\n    if (!this.data.length) this.element.classList.add('sortable-table_empty');\r\n    else this.element.classList.remove('sortable-table_empty');\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(this.data);\r\n  }\r\n\r\n  addRows(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.getTableRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `<div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n      ${this.headersConfig.map(item => this.getHeaderRow(item)).join('')}\r\n    </div>`;\r\n  }\r\n\r\n  getHeaderRow({ id, title, sortable }) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${order}\">\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => this.rowTemplate(this.getTableRow(item), item)).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({ id, template }) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells\r\n      .map(({ id, template }) => {\r\n        return template\r\n          ? template(item[id])\r\n          : `<div class=\"sortable-table__cell\">${item[id]}</div>`;\r\n      })\r\n      .join('');\r\n  }\r\n\r\n  getTable() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          No products\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    if (this.scrollLoad) document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  sortOnClient(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order) {\r\n    this.start = 0;\r\n    this.end = this.start + this.step;\r\n\r\n    this.subElements.body.innerHTML = '';\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find(item => item.id === id);\r\n    const { sortType, customSorting } = column;\r\n    const direction = order === 'asc' ? 1 : -1;\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], 'ru');\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.subElements = {};\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n}\r\n","class Tooltip {\r\n  static instance = null;\r\n  element;\r\n\r\n  moveHandler = (event) => {\r\n    const displace = 10;\r\n    this.element.style.left = event.clientX + displace + \"px\";\r\n    this.element.style.top = event.clientY + displace + \"px\";\r\n  };\r\n\r\n  overHandler = (event) => {\r\n    const target = event.target.closest(\"[data-tooltip]\");\r\n    if (target) {\r\n      this.render(target.dataset.tooltip);\r\n      document.addEventListener(\"pointermove\", this.moveHandler);\r\n    }\r\n  };\r\n\r\n  outHandler = () => {\r\n    this.remove();\r\n    document.removeEventListener(\"pointermove\", this.moveHandler);\r\n  };\r\n\r\n  constructor() {\r\n    if (!Tooltip.instance) Tooltip.instance = this;\r\n    return Tooltip.instance;\r\n  }\r\n  render(html) {\r\n    this.element = document.createElement(\"div\");\r\n    this.element.className = \"tooltip\";\r\n    this.element.innerHTML = html;\r\n    document.body.append(this.element);\r\n  }\r\n  initialize() {\r\n    document.addEventListener(\"pointerover\", this.overHandler);\r\n    document.addEventListener(\"pointerout\", this.outHandler);\r\n  }\r\n  remove() {\r\n    if (this.element) this.element.remove();\r\n  }\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    Tooltip.instance = null;\r\n    document.removeEventListener(\"pointerover\", this.overHandler);\r\n    document.removeEventListener(\"pointerout\", this.outHandler);\r\n    document.removeEventListener(\"pointermove\", this.moveHandler);\r\n  }\r\n}\r\n\r\nexport default Tooltip;\r\n"],"sourceRoot":""}