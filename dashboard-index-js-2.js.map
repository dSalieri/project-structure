{"version":3,"sources":["webpack:///./src/components/column-chart/index.js","webpack:///./src/pages/dashboard/bestsellers-header.js","webpack:///./src/pages/dashboard/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/notification/index.js","webpack:///./src/utils/comma.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/range-picker/index.js","webpack:///./src/components/tooltip/index.js"],"names":["ColumnChart","constructor","label","link","formatHeading","data","url","range","from","Date","to","isBarHighlight","Promise","resolve","this","isLoaded","event","target","closest","classList","toggle","URL","render","element","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","loadData","events","getHeaderValue","Object","values","reduce","accum","item","add","header","textContent","body","searchParams","set","toISOString","fetchJson","setNewRange","length","getColumnBody","remove","maxValue","Math","max","entries","map","key","value","scale","chartHeight","tooltip","toLocaleString","dateStyle","floor","join","getLink","querySelectorAll","subElement","dataset","type","onOverOut","destroy","id","title","sortable","sortType","category","catTitle","price","comma","Page","components","sortableTable","update","ordersChart","salesChart","customersChart","initComponents","now","setMonth","getMonth","rangePicker","RangePicker","SortableTable","isSortLocally","scrollLoad","rowTemplate","Tooltip","initialize","renderComponents","keys","forEach","component","root","append","initEventListeners","acc","addEventListener","detail","updateComponents","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","Notification","duration","show","NotificationMessage","wrapper","activeMessage","timerId","setTimeout","clearTimeout","num","String","reverse","chr","index","push","headersConfig","sorted","find","order","step","start","end","async","bottom","getBoundingClientRect","documentElement","clientHeight","loading","addRows","column","newOrder","asc","desc","toggleOrder","arrow","sortOnClient","sortOnServer","getTable","renderRows","getTableRows","rows","childNodes","getTableHeader","getHeaderRow","getHeaderSortingArrow","getTableBody","getTableRow","onSortClick","onWindowScroll","sortedData","sortData","arr","customSorting","direction","sort","a","b","localeCompare","removeEventListener","date","isOpen","contains","isRangePicker","close","showDateFrom","selected","formatDate","input","selector","onDocumentClick","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","showDate1","showDate2","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","cellDate","selectedFromElem","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","getDate","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles","style","left","clientX","top","clientY","moveHandler","instance","html","className","overHandler","outHandler"],"mappings":"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","file":"dashboard-index-js-2.js","sourcesContent":["import fetchJson from \"../../utils/fetch-json.js\";\r\n\r\nconst BACKEND_URL = \"https://course-js.javascript.ru\";\r\n\r\nexport default class ColumnChart {\r\n  element;\r\n  subElements = {};\r\n  chartHeight = 50;\r\n  isLoaded;\r\n  componentIsLoaded = new Promise((resolve) => {\r\n    this.isLoaded = resolve;\r\n  });\r\n\r\n  onOverOut = (event) => {\r\n    const target = event.target.closest(\".column-chart__element\");\r\n    if (target) {\r\n      const container = target.closest(\".column-chart__chart\");\r\n      container.classList.toggle(\"has-hovered\");\r\n      target.classList.toggle(\"is-hovered\");\r\n    }\r\n  };\r\n\r\n  constructor({\r\n    label = \"\",\r\n    link = \"\",\r\n    formatHeading = (data) => data,\r\n    url = \"\",\r\n    range = {\r\n      from: new Date(),\r\n      to: new Date(),\r\n    },\r\n    isBarHighlight = true,\r\n  } = {}) {\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.range = range;\r\n    this.label = label;\r\n    this.link = link;\r\n    this.formatHeading = formatHeading;\r\n    this.isBarHighlight = isBarHighlight;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const { from, to } = this.range;\r\n    const element = document.createElement(\"div\");\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    await this.loadData(from, to);\r\n\r\n    this.isLoaded();\r\n\r\n    if (this.isBarHighlight) this.events(\"add\");\r\n  }\r\n\r\n  getHeaderValue(data) {\r\n    return this.formatHeading(\r\n      Object.values(data).reduce((accum, item) => accum + item, 0)\r\n    );\r\n  }\r\n\r\n  async loadData(from, to) {\r\n    this.element.classList.add(\"column-chart_loading\");\r\n    this.subElements.header.textContent = \"\";\r\n    this.subElements.body.innerHTML = \"\";\r\n\r\n    this.url.searchParams.set(\"from\", from.toISOString());\r\n    this.url.searchParams.set(\"to\", to.toISOString());\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.setNewRange(from, to);\r\n\r\n    if (data && Object.values(data).length) {\r\n      this.subElements.header.textContent = this.getHeaderValue(data);\r\n      this.subElements.body.innerHTML = this.getColumnBody(data);\r\n\r\n      this.element.classList.remove(\"column-chart_loading\");\r\n    }\r\n  }\r\n\r\n  setNewRange(from, to) {\r\n    this.range.from = from;\r\n    this.range.to = to;\r\n  }\r\n\r\n  getColumnBody(data) {\r\n    const maxValue = Math.max(...Object.values(data));\r\n\r\n    return Object.entries(data)\r\n      .map(([key, value]) => {\r\n        const scale = this.chartHeight / maxValue;\r\n        const tooltip = `<span>\r\n        <small>${key.toLocaleString(\"default\", { dateStyle: \"medium\" })}</small>\r\n        <br>\r\n        <strong>${this.formatHeading(value)}</strong>\r\n      </span>`;\r\n\r\n        return `<div class=\"column-chart__element\" style=\"--value: ${Math.floor(\r\n          value * scale\r\n        )}\" data-tooltip=\"${tooltip}\"></div>`;\r\n      })\r\n      .join(\"\");\r\n  }\r\n\r\n  getLink() {\r\n    return this.link\r\n      ? `<a class=\"column-chart__link\" href=\"${this.link}\">View all</a>`\r\n      : \"\";\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"column-chart column-chart_loading\" style=\"--chart-height: ${\r\n        this.chartHeight\r\n      }\">\r\n        <div class=\"column-chart__title\">\r\n          Total ${this.label}\r\n          ${this.getLink()}\r\n        </div>\r\n        <div class=\"column-chart__container\">\r\n          <div data-element=\"header\" class=\"column-chart__header\"></div>\r\n          <div data-element=\"body\" class=\"column-chart__chart\"></div>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll(\"[data-element]\");\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  async update(from, to) {\r\n    return await this.loadData(from, to);\r\n  }\r\n\r\n  events(type) {\r\n    this.element[`${type}EventListener`](\"pointerover\", this.onOverOut);\r\n    this.element[`${type}EventListener`](\"pointerout\", this.onOverOut);\r\n  }\r\n\r\n  destroy() {\r\n    this.element.remove();\r\n    this.events(\"remove\");\r\n  }\r\n}\r\n","import comma from \"../../utils/comma.js\";\r\n\r\nconst header = [\r\n  {\r\n    id: \"images\",\r\n    title: \"Image\",\r\n    sortable: false,\r\n    template: (data = []) => {\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0] && data[0].url}\">\r\n        </div>\r\n      `;\r\n    },\r\n  },\r\n  {\r\n    id: \"title\",\r\n    title: \"Name\",\r\n    sortable: true,\r\n    sortType: \"string\",\r\n  },\r\n  {\r\n    id: \"subcategory\",\r\n    title: \"Category\",\r\n    sortable: false,\r\n    template: ({ category: { title: catTitle }, title } = {}) => {\r\n      const template = `\r\n        <div class='sortable-table-tooltip'>\r\n          <span class='sortable-table-tooltip__category'>${catTitle}</span> /\r\n          <b class='sortable-table-tooltip__subcategory'>${title}</b>\r\n        </div>\r\n      `;\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <span data-tooltip=\"${template}\">${title}</span>\r\n        </div>\r\n      `;\r\n    },\r\n  },\r\n  {\r\n    id: \"quantity\",\r\n    title: \"Quantity\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n  },\r\n  {\r\n    id: \"price\",\r\n    title: \"Price\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (price) => {\r\n      return `<div class=\"sortable-table__cell\">${comma(price)}$</div>`;\r\n    },\r\n  },\r\n  /*{\r\n    id: \"status\",\r\n    title: \"Status\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n    template: (data) => {\r\n      return `<div class=\"sortable-table__cell\">\r\n          ${data > 0 ? \"Active\" : \"Inactive\"}\r\n        </div>`;\r\n    }\r\n  },*/\r\n  {\r\n    id: \"sales\",\r\n    title: \"Sales\",\r\n    sortable: true,\r\n    sortType: \"number\",\r\n  },\r\n];\r\n\r\nexport default header;\r\n","import RangePicker from '../../components/range-picker/index.js';\r\nimport SortableTable from '../../components/sortable-table/index.js';\r\nimport ColumnChart from '../../components/column-chart/index.js';\r\nimport Tooltip from '../../components/tooltip/index.js';\r\nimport header from './bestsellers-header.js';\r\n\r\nimport fetchJson from '../../utils/fetch-json.js';\r\nimport comma from '../../utils/comma.js';\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru/';\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n  url = new URL('api/dashboard/bestsellers', BACKEND_URL);\r\n\r\n  async updateComponents(from, to) {\r\n    this.components.sortableTable.update(() => this.loadData(from, to));\r\n    this.components.ordersChart.update(from, to);\r\n    this.components.salesChart.update(from, to);\r\n    this.components.customersChart.update(from, to);\r\n  }\r\n\r\n  loadData(from, to) {\r\n    this.url.searchParams.set('_start', '0');\r\n    this.url.searchParams.set('_end', '19');\r\n    this.url.searchParams.set('_sort', 'title');\r\n    this.url.searchParams.set('_order', 'asc');\r\n    this.url.searchParams.set('from', from.toISOString());\r\n    this.url.searchParams.set('to', to.toISOString());\r\n\r\n    return fetchJson(this.url);\r\n  }\r\n\r\n  initComponents() {\r\n    const now = new Date();\r\n    const to = new Date();\r\n    const from = new Date(now.setMonth(now.getMonth() - 1));\r\n\r\n    const rangePicker = new RangePicker({ from, to });\r\n\r\n    const sortableTable = new SortableTable(header, {\r\n      url: `api/dashboard/bestsellers?from=${from.toISOString()}&to=${to.toISOString()}`,\r\n      isSortLocally: true,\r\n      scrollLoad: false,\r\n      rowTemplate: (data, item) =>\r\n        `<a href=\"/products/${item.id}\" class=\"sortable-table__row\">${data}</a>`\r\n    });\r\n\r\n    const ordersChart = new ColumnChart({\r\n      url: 'api/dashboard/orders',\r\n      range: { from, to },\r\n      label: 'orders',\r\n      link: '/sales'\r\n    });\r\n\r\n    const salesChart = new ColumnChart({\r\n      url: 'api/dashboard/sales',\r\n      range: { from, to },\r\n      label: 'sales',\r\n      formatHeading: value => `${comma(value)}$`\r\n    });\r\n\r\n    const customersChart = new ColumnChart({\r\n      url: 'api/dashboard/customers',\r\n      range: { from, to },\r\n      label: 'customers'\r\n    });\r\n\r\n    const tooltip = new Tooltip();\r\n    tooltip.initialize();\r\n\r\n    this.components = {\r\n      rangePicker,\r\n      sortableTable,\r\n      ordersChart,\r\n      salesChart,\r\n      customersChart,\r\n      tooltip\r\n    };\r\n  }\r\n  renderComponents() {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      if (element) root.append(element);\r\n    });\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"dashboard\">\r\n        <div class=\"content__top-panel\">\r\n          <h2 class=\"page-title\">Dashboard</h2>\r\n          <!-- RangePicker component -->\r\n          <div data-element=\"rangePicker\"></div>\r\n        </div>\r\n        <div data-element=\"chartsRoot\" class=\"dashboard__charts\">\r\n          <!-- column-chart components -->\r\n          <div data-element=\"ordersChart\" class=\"dashboard__chart_orders\"></div>\r\n          <div data-element=\"salesChart\" class=\"dashboard__chart_sales\"></div>\r\n          <div data-element=\"customersChart\" class=\"dashboard__chart_customers\"></div>\r\n        </div>\r\n        <h3 class=\"block-title\">Best sellers</h3>\r\n        <div data-element=\"sortableTable\">\r\n          <!-- sortable-table component -->\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n    element.innerHTML = this.template;\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.initComponents();\r\n    this.renderComponents();\r\n    this.initEventListeners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((acc, subElement) => {\r\n      acc[subElement.dataset.element] = subElement;\r\n\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.components.rangePicker.element.addEventListener('date-select', event => {\r\n      const { from, to } = event.detail;\r\n      this.updateComponents(from, to);\r\n    });\r\n  }\r\n\r\n  remove() {\r\n    if (this.element) this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\nimport Notification from \"../components/notification/index.js\";\r\n\r\nexport default async function (url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // TODO: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch (err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText =\r\n        (body.error && body.error.message) ||\r\n        (body.data && body.data.error && body.data.error.message) ||\r\n        errorText;\r\n    } catch (error) {\r\n      /* ignore failed body */\r\n    }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch (err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener(\"unhandledrejection\", (event) => {\r\n  if (event.reason instanceof FetchError) {\r\n    ///alert(event.reason.message);\r\n      const notification = new Notification(event.reason.message, {\r\n        duration: 3000,\r\n        type: 'error'\r\n      });\r\n      notification.show();\r\n  }\r\n});\r\n","export default class NotificationMessage {\r\n  static activeMessage;\r\n  element;\r\n\r\n  constructor(message, { duration = 1000, type = \"success\" } = {}) {\r\n    this.message = message;\r\n    this.duration = duration;\r\n    this.type = type;\r\n    this.createElement();\r\n  }\r\n  get template() {\r\n    return /*html*/ `\r\n      <div class=\"notification notification_${this.type}\" style=\"--value:${\r\n      this.duration / 1000\r\n    }s\">\r\n        <div class=\"notification__content notification__content_show\">\r\n            ${this.message}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n  createElement() {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n  }\r\n  show(target = document.body) {\r\n    if (NotificationMessage.activeMessage)\r\n      NotificationMessage.activeMessage.remove();\r\n\r\n    target.append(this.element);\r\n\r\n    this.timerId = setTimeout(() => {\r\n      this.remove();\r\n    }, this.duration);\r\n\r\n    NotificationMessage.activeMessage = this;\r\n  }\r\n  remove() {\r\n    clearTimeout(this.timerId);\r\n    if (this.element) this.element.remove();\r\n  }\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    NotificationMessage.activeMessage = null;\r\n  }\r\n}\r\n","export default function comma(num) {\r\n  num = String(num);\r\n  return [...num]\r\n    .reverse()\r\n    .reduce((acc, chr, index) => {\r\n      acc.push(chr);\r\n      if ((index + 1) % 3 === 0 && index < num.length - 1) acc.push(\",\");\r\n      return acc;\r\n    }, [])\r\n    .reverse()\r\n    .join(\"\");\r\n}\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  isLoaded;\r\n  componentIsLoaded = new Promise(resolve => {\r\n    this.isLoaded = resolve;\r\n  });\r\n\r\n  onWindowScroll = async () => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading) {\r\n      this.loading = true;\r\n\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.addRows(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n    const toggleOrder = order => {\r\n      const orders = {\r\n        asc: 'desc',\r\n        desc: 'asc'\r\n      };\r\n\r\n      return orders[order];\r\n    };\r\n\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const newOrder = toggleOrder(order);\r\n\r\n      this.sorted = {\r\n        id,\r\n        order: newOrder\r\n      };\r\n\r\n      column.dataset.order = newOrder;\r\n      column.append(this.subElements.arrow);\r\n\r\n      if (this.isSortLocally) {\r\n        this.sortOnClient(id, newOrder);\r\n      } else {\r\n        this.sortOnServer(id, newOrder);\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(\r\n    headersConfig = [],\r\n    {\r\n      url = '',\r\n      sorted = {\r\n        id: headersConfig.find(item => item.sortable).id,\r\n        order: 'asc'\r\n      },\r\n      isSortLocally = false,\r\n      scrollLoad = true,\r\n      rowTemplate = data => `<div class=\"sortable-table__row\">${data}</div>`,\r\n      step = 20,\r\n      start = 0,\r\n      end = start + step\r\n    } = {}\r\n  ) {\r\n    this.headersConfig = headersConfig;\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.scrollLoad = scrollLoad;\r\n    this.rowTemplate = rowTemplate;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const { id, order } = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTable();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.isLoaded();\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  async update(data) {\r\n    this.subElements.body.innerHTML = '';\r\n    if (typeof data === 'function') {\r\n      this.element.classList.add('sortable-table_loading');\r\n      this.data = await data();\r\n      this.element.classList.remove('sortable-table_loading');\r\n    } else {\r\n      let {\r\n        id = this.sorted.id,\r\n        order = this.sorted.order,\r\n        start = this.start,\r\n        end = this.end\r\n      } = data || {};\r\n      this.data = await this.loadData(id, order, start, end);\r\n    }\r\n\r\n    if (!this.data.length) this.element.classList.add('sortable-table_empty');\r\n    else this.element.classList.remove('sortable-table_empty');\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(this.data);\r\n  }\r\n\r\n  addRows(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.getTableRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `<div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n      ${this.headersConfig.map(item => this.getHeaderRow(item)).join('')}\r\n    </div>`;\r\n  }\r\n\r\n  getHeaderRow({ id, title, sortable }) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${order}\">\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => this.rowTemplate(this.getTableRow(item), item)).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({ id, template }) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells\r\n      .map(({ id, template }) => {\r\n        return template\r\n          ? template(item[id])\r\n          : `<div class=\"sortable-table__cell\">${item[id]}</div>`;\r\n      })\r\n      .join('');\r\n  }\r\n\r\n  getTable() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          No products\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    if (this.scrollLoad) document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  sortOnClient(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order) {\r\n    this.start = 0;\r\n    this.end = this.start + this.step;\r\n\r\n    this.subElements.body.innerHTML = '';\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find(item => item.id === id);\r\n    const { sortType, customSorting } = column;\r\n    const direction = order === 'asc' ? 1 : -1;\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], 'ru');\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.subElements = {};\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n}\r\n","export default class RangePicker {\r\n  element = null;\r\n  subElements = {};\r\n  selectingFrom = true;\r\n  selected = {\r\n    from: new Date(),\r\n    to: new Date()\r\n  };\r\n\r\n  static formatDate(date) {\r\n    return date.toLocaleString('ru', {dateStyle: 'short'});\r\n  }\r\n\r\n  onDocumentClick = event => {\r\n    const isOpen = this.element.classList.contains('rangepicker_open');\r\n    const isRangePicker = this.element.contains(event.target);\r\n\r\n    if (isOpen && !isRangePicker) {\r\n      this.close();\r\n    }\r\n  };\r\n\r\n  constructor({from = new Date(), to = new Date()} = {}) {\r\n    this.showDateFrom = new Date(from);\r\n    this.selected = {from, to};\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    const from = RangePicker.formatDate(this.selected.from);\r\n    const to = RangePicker.formatDate(this.selected.to);\r\n\r\n    return `<div class=\"rangepicker\">\r\n      <div class=\"rangepicker__input\" data-element=\"input\">\r\n        <span data-element=\"from\">${from}</span> -\r\n        <span data-element=\"to\">${to}</span>\r\n      </div>\r\n      <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const subElements = {};\r\n\r\n    for (const subElement of element.querySelectorAll('[data-element]')) {\r\n      subElements[subElement.dataset.element] = subElement;\r\n    }\r\n\r\n    return subElements;\r\n  }\r\n\r\n  initEventListeners() {\r\n    const {input, selector} = this.subElements;\r\n\r\n    document.addEventListener('click', this.onDocumentClick, true);\r\n    input.addEventListener('click', () => this.toggle());\r\n    selector.addEventListener('click', event => this.onSelectorClick(event));\r\n  }\r\n\r\n  toggle() {\r\n    this.element.classList.toggle('rangepicker_open');\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  onSelectorClick({target}) {\r\n    if (target.classList.contains('rangepicker__cell')) {\r\n      this.onRangePickerCellClick(target);\r\n    }\r\n  }\r\n\r\n  close() {\r\n    this.element.classList.remove('rangepicker_open');\r\n  }\r\n\r\n  renderDateRangePicker() {\r\n    const showDate1 = new Date(this.showDateFrom);\r\n    const showDate2 = new Date(this.showDateFrom);\r\n    const { selector } = this.subElements;\r\n\r\n    showDate2.setMonth(showDate2.getMonth() + 1);\r\n\r\n    selector.innerHTML = `\r\n      <div class=\"rangepicker__selector-arrow\"></div>\r\n      <div class=\"rangepicker__selector-control-left\"></div>\r\n      <div class=\"rangepicker__selector-control-right\"></div>\r\n      ${this.renderCalendar(showDate1)}\r\n      ${this.renderCalendar(showDate2)}\r\n    `;\r\n\r\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\r\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\r\n\r\n    controlLeft.addEventListener('click', () => this.prev());\r\n    controlRight.addEventListener('click', () => this.next());\r\n\r\n    this.renderHighlight();\r\n  }\r\n\r\n  prev() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  next() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  renderHighlight() {\r\n    const { from, to } = this.selected;\r\n\r\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\r\n      const { value } = cell.dataset;\r\n      const cellDate = new Date(value);\r\n\r\n      cell.classList.remove('rangepicker__selected-from');\r\n      cell.classList.remove('rangepicker__selected-between');\r\n      cell.classList.remove('rangepicker__selected-to');\r\n\r\n      if (from && value === from.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-from');\r\n      } else if (to && value === to.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-to');\r\n      } else if (from && to && cellDate >= from && cellDate <= to) {\r\n        cell.classList.add('rangepicker__selected-between');\r\n      }\r\n    }\r\n\r\n    if (from) {\r\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\r\n      if (selectedFromElem) {\r\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\r\n      }\r\n    }\r\n\r\n    if (to) {\r\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\r\n      if (selectedToElem) {\r\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCalendar(showDate) {\r\n    const date = new Date(showDate);\r\n    const getGridStartIndex = dayIndex => {\r\n      const index = dayIndex === 0 ? 6 : (dayIndex - 1); // make Sunday (0) the last day\r\n      return index + 1;\r\n    };\r\n\r\n    date.setDate(1);\r\n\r\n    // text-transform: capitalize\r\n    const monthStr = date.toLocaleString('ru', {month: 'long'});\r\n\r\n    let table = `<div class=\"rangepicker__calendar\">\r\n      <div class=\"rangepicker__month-indicator\">\r\n        <time datetime=${monthStr}>${monthStr}</time>\r\n      </div>\r\n      <div class=\"rangepicker__day-of-week\">\r\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\r\n      </div>\r\n      <div class=\"rangepicker__date-grid\">\r\n    `;\r\n\r\n    // first day of month starts after a space\r\n    // * * * 1 2 3 4\r\n    table += `\r\n      <button type=\"button\"\r\n        class=\"rangepicker__cell\"\r\n        data-value=\"${date.toISOString()}\"\r\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\r\n          ${date.getDate()}\r\n      </button>`;\r\n\r\n    date.setDate(2);\r\n\r\n    while (date.getMonth() === showDate.getMonth()) {\r\n      table += `\r\n        <button type=\"button\"\r\n          class=\"rangepicker__cell\"\r\n          data-value=\"${date.toISOString()}\">\r\n            ${date.getDate()}\r\n        </button>`;\r\n\r\n      date.setDate(date.getDate() + 1);\r\n    }\r\n\r\n    // close the table\r\n    table += '</div></div>';\r\n\r\n    return table;\r\n  }\r\n\r\n  onRangePickerCellClick(target) {\r\n    const { value } = target.dataset;\r\n\r\n    if (value) {\r\n      const dateValue = new Date(value);\r\n\r\n      if (this.selectingFrom) {\r\n        this.selected = {\r\n          from: dateValue,\r\n          to: null\r\n        };\r\n        this.selectingFrom = false;\r\n        this.renderHighlight();\r\n      } else {\r\n        if (dateValue > this.selected.from) {\r\n          this.selected.to = dateValue;\r\n        } else {\r\n          this.selected.to = this.selected.from;\r\n          this.selected.from = dateValue;\r\n        }\r\n\r\n        this.selectingFrom = true;\r\n        this.renderHighlight();\r\n      }\r\n\r\n      if (this.selected.from && this.selected.to) {\r\n        this.dispatchEvent();\r\n        this.close();\r\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\r\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to);\r\n      }\r\n    }\r\n  }\r\n\r\n  dispatchEvent() {\r\n    this.element.dispatchEvent(new CustomEvent('date-select', {\r\n      bubbles: true,\r\n      detail: this.selected\r\n    }));\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n    // TODO: Warning! To remove listener MUST be passes the same event phase\r\n    document.removeEventListener('click', this.onDocumentClick, true);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n    this.selectingFrom = true;\r\n    this.selected = {\r\n      from: new Date(),\r\n      to: new Date()\r\n    };\r\n\r\n    return this;\r\n  }\r\n}\r\n","class Tooltip {\r\n  static instance = null;\r\n  element;\r\n\r\n  moveHandler = (event) => {\r\n    const displace = 10;\r\n    this.element.style.left = event.clientX + displace + \"px\";\r\n    this.element.style.top = event.clientY + displace + \"px\";\r\n  };\r\n\r\n  overHandler = (event) => {\r\n    const target = event.target.closest(\"[data-tooltip]\");\r\n    if (target) {\r\n      this.render(target.dataset.tooltip);\r\n      document.addEventListener(\"pointermove\", this.moveHandler);\r\n    }\r\n  };\r\n\r\n  outHandler = () => {\r\n    this.remove();\r\n    document.removeEventListener(\"pointermove\", this.moveHandler);\r\n  };\r\n\r\n  constructor() {\r\n    if (!Tooltip.instance) Tooltip.instance = this;\r\n    return Tooltip.instance;\r\n  }\r\n  render(html) {\r\n    this.element = document.createElement(\"div\");\r\n    this.element.className = \"tooltip\";\r\n    this.element.innerHTML = html;\r\n    document.body.append(this.element);\r\n  }\r\n  initialize() {\r\n    document.addEventListener(\"pointerover\", this.overHandler);\r\n    document.addEventListener(\"pointerout\", this.outHandler);\r\n  }\r\n  remove() {\r\n    if (this.element) this.element.remove();\r\n  }\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    Tooltip.instance = null;\r\n    document.removeEventListener(\"pointerover\", this.overHandler);\r\n    document.removeEventListener(\"pointerout\", this.outHandler);\r\n    document.removeEventListener(\"pointermove\", this.moveHandler);\r\n  }\r\n}\r\n\r\nexport default Tooltip;\r\n"],"sourceRoot":""}